-- department-top-three-salaries
A company's executives are interested in seeing who earns the most money in each of the company's departments. A high earner in a department is an employee who has a salary in the top three unique salaries for that department.

Write an SQL query to find the employees who are high earners in each of the departments.


select d1.name as 'Department' ,e1.name as 'Employee', e1.salary
from employee e1
join department d1
on e1.departmentid = d1.id
where 3 > (select count(distinct e2.salary) from employee e2
           where e2.salary > e1.salary
           and e2.departmentid = e1.departmentid

)



-- Nth-highest-salary
Write an SQL query to report the nth highest salary from the Employee table. If there is no nth highest salary, the query should report null.

select * from employee 
where sal in (select min(sal) from (select distinct top N sal from employee
                            order by sal desc))




-- Rank Scores 
Write an SQL query to rank the scores. The ranking should be calculated according to the following rules:

select s1.score, (select count(distinct s2.score) from scores s2 where s2.score >= s1.score ) rank
from scores s1

order by s1.score desc
